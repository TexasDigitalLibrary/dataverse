<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:jsf="http://xmlns.jcp.org/jsf">

    <h:head>
    </h:head>

    <h:body>    				
        <f:metadata>
         	<f:viewParam name="userId" value="#{AuthenticationResponse.userId}"/>
            <f:viewParam name="redirectPage" value="#{LoginPage.redirectPage}"/>
        </f:metadata>
        <ui:composition template="/dataverse_template.xhtml">        	
            <ui:param name="pageTitle" value="#{bundle.login} - #{dataverseServiceBean.findRootDataverse().name} #{bundle.dataverse}"/>
            <ui:param name="showDataverseHeader" value="false"/>
            <ui:param name="showMessagePanel" value="#{true}"/>
            <ui:param name="loginRedirectPage" value="dataverse.xhtml"/>
            <ui:define name="body">
            	<script type="text/javascript" src="#{resource['js/Duo-Web-v2.min.js']}"></script>
                <div id="login-container" class="row">
					<p>#{TwoFactorPage.getTitle(param['idpId'])}</p>
                    <div class="panel panel-default highlight col-md-12">
                        <div class="panel-body row">
							<iframe id="duo_iframe"
							 	width="620"
							 	height="330"
							 	data-host="#{TwoFactorPage.getHostname(param['idpId'])}"
							 	data-sig-request="#{TwoFactorPage.getToken(param['idpId'], param['username'])}"
							 	data-post-action="/two-factor/callback.xhtml"
							 	frameborder="0"
							 	>
							<form method="POST" style="display:none;" id="duo_form">
								<input type="hidden" name="foo" value="bar"/>
								<input type="hidden" name="provider" value="duo"/>
							</form>
							</iframe>
                        </div>
                    </div>
                </div>				
            </ui:define>
        </ui:composition>
    </h:body>
</html>